
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Modeling Extreme Log Returns of S&P 500 Index &middot; keenan's log.
    
  </title>

  
    <meta name="description" content="Applying Extreme Value Theory to ten years of daily log returns for the S&P 500 Index."/>
    <meta name="keywords" content="extreme value theory, gjr-garch, generalized pareto, value-at-risk">
  
  <meta name="author" content="Heiswayi Nrird">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@keenangao">
  <meta name="twitter:creator" content="@keenangao">
  
    <meta name="twitter:title" content="Modeling Extreme Log Returns of S&P 500 Index">
    <meta name="twitter:description" content="Applying Extreme Value Theory to ten years of daily log returns for the S&P 500 Index.">
  

  <meta property="og:type" content="website"/>
  
    <meta property="og:title" content="Modeling Extreme Log Returns of S&P 500 Index"/>
    <meta property="og:url" content="/sp500-extreme-value-theory.html"/>
    <meta property="og:description" content="Applying Extreme Value Theory to ten years of daily log returns for the S&P 500 Index."/>
    <meta property="og:site_name" content="Modeling Extreme Log Returns of S&P 500 Index"/>
  

  <link rel="apple-touch-icon" sizes="57x57" href="/public/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/public/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/public/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/public/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/public/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/public/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/public/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/public/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/public/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/public/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/public/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/public/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/public/icons/favicon-16x16.png">
  <link rel="manifest" href="/public/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#f3f3f3">
  <meta name="msapplication-TileImage" content="/public/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="aSavCGGU0uSN5HEHnI7ZiMqVKxn7mfUPCGMVJvmDQ1w" />
  <meta name="wot-verification" content="6da2597a332a1fadad8f"/>

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <link rel="stylesheet" href="/public/css/normalize.css">
  <link rel="stylesheet" href="/public/css/style.css">
   <link rel="stylesheet" href="/public/css/font-awesome.min.css"> 

<script src="/public/js/modernizr.custom.js"></script>
  <script src="/public/js/jquery-1.11.2.min.js"></script>
  <script src="/public/js/masonry.pkgd.min.js"></script>
  <script type="text/javascript" async
		  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>	
  <script src="/public/js/jquery.tablesorter.js"> </script>
  <!--[if lt IE 9]>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.1.0/respond.min.js"></script>
    <script src="/public/js/rem.min.js"></script>
  <![endif]-->
</head>


  <body>
    <div class="wrap">
      <div class="master-nav">
        <div class="nav">
            <ul class="top-menu">
              <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
              <li><a href="/about.html"><i class="fa fa-info-circle"></i> About</a></li>
              <li><a href="/notes.html"><i class="fa fa-pencil"></i> Notes</a></li>
              <li><a class="resume" href="http://x-axis.github.io/resume/"><i class="fa fa-file-text-o"></i> Resume</a></li>
              <li><a class="special" href="https://github.com/x-axis?tab=repositories/"><i class="fa fa-github-alt"></i> Repositories</a></li>
              <li><a class="special" href="https://gist.github.com/x-axis"><i class="fa fa-code"></i> Gists</a></li>
              <li><a class="unique" href="http://keenan.ml"><i class="fa fa-camera-retro"></i> Photography</a></li>
            </ul>
        </div>
      </div>

      <div class="masthead">
        <div class="container">
          <h2 class="masthead-title">
            <a href="/" title="Home">keenan's log.</a>
            <small>Notes on things so that I don't forget them.</small>
          </h2>

          <div class="footer-social-links">
  <a href="https://my.linkedin.com/in/keenan-gan" title="LinkedIn" target="_blank"><i class="fa fa-linkedin"></i></a>
  <a href="https://twitter.com/keenangao" title="Twitter" target="_blank"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/x-axis" title="GitHub" target="_blank"><i class="fa fa-github-alt"></i></a>
  <a href="https://gist.github.com/x-axis" title="GitHub Gist" target="_blank"><i class="fa fa-code"></i></a>
  <a href="https://500px.com/keenangao" title="500px" target="_blank"><i class="fa fa-500px"></i></a>
</div>


        </div>
      </div>

      <div class="container content">
        <div class="post">
  <div class="post-top-meta">
    <div class="post-date">October 19, 2016 &middot; <span class="reading-time" title="Estimated Reading Time">
  
  
    2 minutes read
  
</span>
</div>
    <h1 class="post-title">Modeling Extreme Log Returns of S&P 500 Index</h1>
  </div>

  <div class="hrline"></div>

  <h1 id="introduction">Introduction</h1>
<p>Prior to Robert Engle’s introduction of ARCH processes in 1982, little methodology existed for modeling the variance of financial returns. At the time, conventional time series models tended to assume constant variance which fell short in capturing the dynamics of financial markets. The ARCH model developed by Engle offered a method of forecasting variance, by weighting a fixed number of previous observations. In 1986, Tim Bollerslev generalized this approach with the GARCH model, which assigned declining weights to all observations and let very old weights approach zero.</p>

<p>These initial models have proved to be simple and robust, but receive criticism for failing to consider the direction of returns. ARCH/GARCH treat negative returns and positive returns symmetrically, but both economic theory and historical trends suggest that volatility responds asymmetrically to market information. In particular, financial markets exhibit a <em>leverage effect</em>, where losses impact volatility more than gains. This asymmetric response naturally leads to an asymmetry in distribution, where the distribution of losses exhibit heavier tails than the distribution of gains.</p>

<h1 id="setup">Setup</h1>

<p>The dataset consists of daily adjusted closing prices for the S&amp;P 500 Index from Thursday November 2, 2006 to Friday October 7th, 2016, with 2,501 days in total. In order to make meaningful comparisons across time by using an invariant quantity, the time series was converted into log returns.  The final dataset consisted of 2,500 daily log returns. Data was sourced from Yahoo Finance under the ^GSPC ticker.</p>

<p>Analysis and results were produced in MATLAB.</p>

<h1 id="gjr-garch11-model">GJR-GARCH(1,1) Model</h1>

<p>In 1993, Glosten, Jagannathan, and Runkle addressed the early ARCH/GARCH criticisms with the GJR-GARCH model, in which asymmetric response weight was differentiated for positive and negative shocks.</p>

<p>For a time series of returns <script type="math/tex">\{r_i\}_{i=1}^n</script>, a drift process <script type="math/tex">\{\mu_t\}</script>, and residuals <script type="math/tex">\varepsilon_i = r_i - \mu_i</script>, the “leveraged” GARCH model can be parameterized as:</p>

<script type="math/tex; mode=display">\begin{equation} 
\sigma^2_t = \alpha_0 + \alpha_1(\varepsilon_{t-1} + \delta|\varepsilon_{t-1}|)^2 + \beta_1\sigma^2_{t-1}
\end{equation}</script>

<p>with <script type="math/tex">% <![CDATA[
\delta^2 < 1 %]]></script>. An additional constraint is required for the existence of unconditional variance, given by <script type="math/tex">% <![CDATA[
\alpha_1(1+\delta^2) + \beta_1 < 1 %]]></script>.</p>

<p>The quasi-log likelihood is:</p>

<script type="math/tex; mode=display">\begin{equation} 
\log \ell_{\theta | \sigma_i} = \frac{1}{2}\sum_{i=1}^n \left[ \left(\frac{\varepsilon_i}{\sigma_i}\right)^2 + \log(2\pi\sigma_i^2)\right]
\end{equation}</script>

<p>where <script type="math/tex">\theta</script> represents the vector of parameters to be simultaneously estimated and <script type="math/tex">\sigma_i^2</script> is specified by Equation (1).</p>

<p>Due to the extremely short time horizon of one day, we can reasonably assume that daily returns have zero drift. Historically, daily equity returns have shown zero or nearly zero drift. Therefore, the residuals used to outfit the quasi-log likelihood are simply the log returns as specified in the Setup section.</p>

<p>A grid of initial seeds was created with initial values of <script type="math/tex">\alpha_0</script> and <script type="math/tex">\alpha_1</script> fixed at 0.1 and 0.01, varying negatively for <script type="math/tex">\delta</script>, and varying positively for <script type="math/tex">\beta_1</script>. The negative quasi-likelihood was minimized for all seeds to find the estimates producing the smallest negative log likelihood. The results are shown in Table I.</p>

  
</div>
<div class="back"><a href="/notes.html"><i class="fa fa-chevron-left"></i> Back</a></div>

      </div>
    </div>

	  <div class="footer">
	<div class="hrline"></div>
	<div class="license">Unless otherwise stated, all original code presented on this site is licensed under the <a href="http://heiswayi.github.io/mit-license">MIT license</a>. All original photographs and text on this website are licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives</a> license.

<script>
$(window).load(function() {
	$('.grid').masonry({
		itemSelector: '.grid-item',
		columnWidth: '.grid-sizer',
		gutter: 10
	});
});
</script>


	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-83123436-1', 'auto');
	    ga('send', 'pageview');

</script>




  </body>
</html>
